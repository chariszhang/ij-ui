import{r as t}from"./form-validator-0e9e5855.js";import{ref as e,reactive as n,computed as a,onUpdated as o,onMounted as c,nextTick as r,warn as d,openBlock as s,createElementBlock as l,createElementVNode as i,withModifiers as u,createVNode as m,Transition as p,withCtx as v,Fragment as f,renderList as h,normalizeClass as g,toDisplayString as w,createCommentVNode as b}from"vue";import{s as x}from"./index-8e56d2a8.js";var S={props:{modelValue:String,hh:String,mm:String,ss:String,format:String,hourStep:[Number,String],minuteStep:[Number,String],secondStep:[Number,String],placeholder:String,disabled:Boolean,readonly:Boolean,validateRule:Object},setup(s,{emit:l}){const i=e({});t({ref:i,props:s});const u=H(0,24,N("hourStep")),m=H(0,60,N("minuteStep")),p=H(0,60,N("secondStep")),v=e(!1),f=n({hh:"",mm:"",ss:""}),h=n({HH:!1,mm:!1,ss:!1}),g=a((()=>{const{hh:t,mm:e,ss:n}=f;if(t||e||n)return I.replace(/HH/g,t).replace(/mm/g,e).replace(/ss/g,n)})),w="HH:mm",b=/(HH|mm|ss)/g,x={HH:3,mm:2,ss:1},S={HH:"hourStep",mm:"minuteStep",ss:"secondStep"};let V,C=[],I="";function M(){r((()=>{if((s.format||w)!==I&&(I=s.format||w,V=RegExp(I.replace(b,"(?<$1>\\d{1,2})")),C=Array.from(new Set(I.match(b)||[])),C.sort(((t,e)=>x[t]-x[e])),C.forEach((t=>h[t]=!0))),s.modelValue&&s.modelValue!==g.value){const t=V.exec(s.modelValue);t&&t.groups?(f.hh=k(Math.min(+t.groups.HH,23)),f.mm=k(Math.min(+t.groups.mm,59)),f.ss=k(Math.min(+t.groups.ss,59))):(d("[time] 输入时间不合法，已将它设置为空",s.modelValue),f.hh=f.mm=f.ss=""),B()}else null===s.modelValue&&(f.hh=f.mm=f.ss="",B())}))}o(M),c(M);let R=!0;function _(){v.value=!1}function B(t,e,n){null==t&&null==e&&null==n||(f.hh=y(f.hh,t),f.mm=y(f.mm,e),f.ss=y(f.ss,n)),l("update:modelValue",g.value),l("update:hh",f.hh),l("update:mm",f.mm),l("update:ss",f.ss),l("change",g.value)}function N(t){const e="hourStep"===t?24:60,n=parseInt(+s[t])||1;return n>e?e:n<1?1:n}return{change:B,calcTime:function(t){let e,n,a=+f.hh||0,o=+f.mm||0,c=+f.ss||0;i.value.focus();const r=new Date;r.setHours(a,o,c),C.forEach(((d,s)=>{let l=N(S[d]);l=1===t?l:-l,"ss"===d&&0===s?(r.setSeconds(c+l),r.getMinutes()!==o&&(e=!0)):"mm"!==d||0!==s&&!e?"HH"!==d||0!==s&&!n||r.setHours(a+l):(r.setMinutes(o+l),r.getHours()!==a&&(n=!0))})),B(r.getHours(),r.getMinutes(),r.getSeconds()),v.value=!1},scrollIntoView:function(t,e){e&&r((()=>{t&&t.scrollIntoViewIfNeeded&&t.scrollIntoViewIfNeeded()}))},containerFocus:function(){R=!1},inputBlur:function(t){setTimeout((()=>R&&_()),100)},focus:function(){R=!0,v.value=!0},blur:_,elementRef:i,valueRef:g,showContentRef:v,HH:u,MM:m,SS:p,dateState:f,listState:h}}};function H(t,e,n=1){const a=[];for(;t<e;t+=n)a.push(k(t));return a}function k(t){return null!=t?String(t).padStart(2,"0"):""}function y(t,e){return null!=e?k(e):t||"00"}const V=["disabled","readonly","value","placeholder"],C={class:"arrows",layout:"column","layout-align":"center center"},I={key:0,class:"content-view",layout:"row"},M={key:0,flex:"",class:"list"},R=["onClick"],_={key:1,flex:"",class:"list"},B=["onClick"],N={key:2,flex:"",class:"list"},z=["onClick"];x(".container[data-v-5d0c11c4] {\n  position: relative;\n  border: none;\n  outline: none;\n  box-shadow: 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05);\n}\n.container[data-v-5d0c11c4] input[data-v-5d0c11c4] {\n  width: 100%;\n  box-sizing: border-box;\n}\n.container[data-v-5d0c11c4] .arrows[data-v-5d0c11c4] {\n  position: absolute;\n  right: 0;\n  top: 0;\n  height: 100%;\n  width: 24px;\n}\n.container[data-v-5d0c11c4] .arrows[data-v-5d0c11c4] .arrow-up[data-v-5d0c11c4],\n.container[data-v-5d0c11c4] .arrows[data-v-5d0c11c4] .arrow-down[data-v-5d0c11c4] {\n  display: block;\n  width: 0;\n  height: 0;\n  cursor: pointer;\n  border-left: 5px solid transparent;\n  border-right: 5px solid transparent;\n}\n.container[data-v-5d0c11c4] .arrows[data-v-5d0c11c4] .arrow-up[data-v-5d0c11c4] {\n  border-bottom: 5px solid #9d9d9d;\n}\n.container[data-v-5d0c11c4] .arrows[data-v-5d0c11c4] .arrow-up[data-v-5d0c11c4][data-v-5d0c11c4]:hover {\n  border-bottom-color: #000000;\n}\n.container[data-v-5d0c11c4] .arrows[data-v-5d0c11c4] .arrow-down[data-v-5d0c11c4] {\n  margin-top: 3px;\n  border-top: 5px solid #9d9d9d;\n}\n.container[data-v-5d0c11c4] .arrows[data-v-5d0c11c4] .arrow-down[data-v-5d0c11c4][data-v-5d0c11c4]:hover {\n  border-top-color: #000000;\n}\n.content-view[data-v-5d0c11c4] {\n  width: 100%;\n  position: absolute;\n  left: 0;\n  top: 30px;\n  background: #fff;\n  z-index: 9999;\n  border: 1px solid #ccc;\n  border-top: 0;\n  box-sizing: border-box;\n  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.25);\n  border-radius: 0 0 5px 5px;\n}\n.content-view[data-v-5d0c11c4] .list[data-v-5d0c11c4] {\n  max-height: 200px;\n  overflow: auto;\n  text-align: center;\n}\n.content-view[data-v-5d0c11c4] .list[data-v-5d0c11c4][data-v-5d0c11c4]:not(:first-child) {\n  border-left: 1px solid #f0f0f0;\n}\n.content-view[data-v-5d0c11c4] .list[data-v-5d0c11c4] .item[data-v-5d0c11c4] {\n  height: 32px;\n  line-height: 32px;\n  font-size: 14px;\n  cursor: pointer;\n}\n.content-view[data-v-5d0c11c4] .list[data-v-5d0c11c4] .item[data-v-5d0c11c4][data-v-5d0c11c4]:hover {\n  background-color: #e7e7e7;\n}\n.content-view[data-v-5d0c11c4] .list[data-v-5d0c11c4] .item[data-v-5d0c11c4].active[data-v-5d0c11c4] {\n  background-color: #3c6bff;\n  color: #fff;\n}\n"),S.render=function(t,e,n,a,o,c){return s(),l("div",{class:"container",tabindex:"1",onBlur:e[7]||(e[7]=(...t)=>a.blur&&a.blur(...t)),onFocus:e[8]||(e[8]=(...t)=>a.containerFocus&&a.containerFocus(...t))},[i("input",{type:"text",class:"form-control",ref:"elementRef","data-type":"time",disabled:n.disabled,readonly:n.disabled,value:a.valueRef,placeholder:n.placeholder,onKeydown:e[0]||(e[0]=u((()=>{}),["prevent","stop"])),onPaste:e[1]||(e[1]=u((()=>{}),["prevent","stop"])),onCut:e[2]||(e[2]=u((()=>{}),["prevent","stop"])),onClick:e[3]||(e[3]=(...t)=>a.focus&&a.focus(...t)),onBlur:e[4]||(e[4]=(...t)=>a.inputBlur&&a.inputBlur(...t))},null,40,V),i("div",C,[i("span",{class:"arrow-up",onClick:e[5]||(e[5]=t=>a.calcTime(1))}),i("span",{class:"arrow-down",onClick:e[6]||(e[6]=t=>a.calcTime(0))})]),m(p,{name:"slide-down"},{default:v((()=>[a.showContentRef?(s(),l("div",I,[a.listState.HH?(s(),l("div",M,[(s(!0),l(f,null,h(a.HH,(t=>(s(),l("div",{class:g(["item",{active:t===a.dateState.hh}]),ref_for:!0,ref:e=>a.scrollIntoView(e,t===a.dateState.hh),onClick:e=>a.change(t)},w(t),11,R)))),256))])):b("v-if",!0),a.listState.mm?(s(),l("div",_,[(s(!0),l(f,null,h(a.MM,(t=>(s(),l("div",{class:g(["item",{active:t===a.dateState.mm}]),ref_for:!0,ref:e=>a.scrollIntoView(e,t===a.dateState.mm),onClick:e=>a.change(null,t)},w(t),11,B)))),256))])):b("v-if",!0),a.listState.ss?(s(),l("div",N,[(s(!0),l(f,null,h(a.SS,(t=>(s(),l("div",{class:g(["item",{active:t===a.dateState.ss}]),ref_for:!0,ref:e=>a.scrollIntoView(e,t===a.dateState.ss),onClick:e=>a.change(null,null,t)},w(t),11,z)))),256))])):b("v-if",!0)])):b("v-if",!0)])),_:1})],32)},S.__scopeId="data-v-5d0c11c4",S.__file="forms/implements/time/time.vue";export{S as default};
